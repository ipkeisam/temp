The following documentation is provided in the https://confluence.capgroup.com/display/CNTEN/Twistlock+Remediation+Guide[Capital Group Confluence].

Twistlock Remediation Guide
Twistlock Console Access
URLs listed here - Twistlock Container Security Management
1.	Please send an email to PDS team with your ad group and we will grant access to the console.
There are three Twistlock console (dev,qa, and prod ), let the PDS team which console the team would like access to. 
2.	PDS Team DL List: PDS_-_Platform_Design_services@capgroup.com
View Vulnerabilities
Twistlock Environments
Twistlock Container Security Management

There are a few places to view your twistlock scan results of your image.
1) Running Images: → Log into Twistlock → Monitor → Vulnerabilities → Images
2) Images in Nexus or ECR Registry: Log into Twistlock → Monitor → Vulnerabilities → Registry
3) Container Build Scanning:  Log into Twistlock → Monitor → Vulnerabilities → Twistcli Scans 

Click on your image, and you'll be able to view all vulnerabilities detected, if there is a fix available, and the version that has the fix. 
 
View all the packages contained in your image, and the path of the binaries. 
 

Remediation Workflow:
 

Twistlock Remediation Scenarios
Dev Instance
Twistlock Remediation Scenarios
Dockerfile Tips
https://snyk.io/blog/10-docker-image-security-best-practices/
•	Use multi-stage builds to 
o	Some artifacts are needed only during build time, you can get rid of these artificats using multi-stage 
o	reduce attack surface by removing unnecessary components from final image
o	reduce size of your final image
•	Use a lightweight base image with fewer OS libraries and tools to lower the risk and attack surface of the container.  
o	ubi-minimal ( rhel based )  
	https://access.redhat.com/containers/#/registry.access.redhat.com/ubi7/ubi-minimal
	https://access.redhat.com/containers/#/registry.access.redhat.com/ubi8/ubi-minimal
o	alpine  
	The Case for Docker Official Images (including Alpine)
•	Regularly update your base image to pull down a newer version.  
o	Vendors regularly updates their base images to include security patches. - 
	https://access.redhat.com/containers/?tab=tags#/registry.access.redhat.com/ubi8/ubi-minimal
•	Pull base images from Nexus Registry Proxy which will pull from secured vendor registries. Vendor registries regularly updates their base images.   
o	Use cgregistry.capgroup.com , which proxies out to vendor registries listed below.
	registry.redhat.io
	quay.io
	mcr.io
Examples of Dockerfile Builds 
•	Using ubi-minimal with multi-stage build
o	https://github.com/open-itg/esi-be-docker-jvm-build/blob/master/Dockerfile
•	Using nginx alpine with mutli-stage build  
o	https://bitbucket.capgroup.com/projects/PADE/repos/openitg-publicsite/browse/Dockerfile
•	 Using ubi-minimal to install nginx 
o	Installing Nginx on RedHat ubi-minimal image
Samples Dockerfile
A prebuilt Apache HTTP Server parent container image is provided in the Quay.io public registry at quay.io/redhattraining/httpd-parent

UBI Image
Universal Base Image (UBI) aims to be a flexible base container image for building containerized applications. You can run containers built using the UBI on Red Hat platforms and non-Red Hat platforms.
•	UBI allows users to build and deploy containerized applications using enterprise-grade container base image that is lightweight and performant.
•	UBI comes from Red Hat Enterprise Linux (RHEL). UBI can be redistributed under the terms of the End User License Agreement (EULA). 
•	UBI follows the same life cycle and support dates as the underlying RHEL. Red Hat maintains a UBI for RHEL 7 and UBI for RHEL 8.
•	Red Hat recommends using the UBI as the base container image for new applications. 
The Red Hat Universal Base Image consists of:
•	A set of three base images (ubi, ubi-minimal, and ubi-init). These mirror what is provided for building containers with RHEL 7 base images.
•	A set of language runtime images (java, php, python, ruby, nodejs). These runtime images enable developers to start developing applications that a Red Hat built and supported container image provides.
•	A set of associated Yum repositories and channels that include RPM packages and updates. These allow you to add application dependencies and rebuild container images.
Types of Universal Base Images
The Red Hat Universal Base Image provides three main base images:
ubi
A standard base image built on enterprise-grade packages from RHEL. Good for most application use cases.
ubi-minimal
A minimal base image built using microdnf, a scaled down version of the dnf utility. This provides the smallest container image.
ubi-init
This image allows you to easily run multiple services, such as web servers, application servers, and databases, all in a single container. It allows you to use the knowledge built into systemd unit files without having to determine how to start the service.

